## Почему крейт `bootloader` подходит только на начальном этапе

Крейт `bootloader` скрывает от разработчика детали загрузки операционной системы. Он автоматически:
- Переключает процессор из 16-битного режима в 32-битный, а затем в 64-битный.
- Настраивает минимальную таблицу страниц памяти.
- Инициализирует сегментные регистры и GDT.
- Подготавливает стек и передаёт управление функции `_start`.

Это позволяет сразу начать писать код на Rust без необходимости реализовывать собственный загрузчик. Однако такая абстракция становится помехой, когда требуется полный контроль над системой.

## Ограничения крейта `bootloader`

1. **Невозможно управлять физической памятью напрямую**  
   Загрузчик сам решает, куда загружать ядро, как выделять страницы и где размещать стек. При реализации менеджера памяти или планировщика задач это недопустимо.

2. **Отсутствие гибкости в настройке окружения**  
   Например, нельзя самостоятельно определить макет GDT, IDT или управлять состоянием регистра CR3. Это критично при реализации виртуальной памяти или обработки прерываний.

3. **Сложность интеграции с внешними компонентами**  
   Загрузчик не предоставляет стандартного интерфейса для передачи данных от firmware (например, multiboot2-информации о карте памяти, списка модулей или ACPI-таблиц). Это необходимо для полноценной ОС.

4. **Зависимость от Cargo и линковки через build.rs**  
   Всё управление загрузочным образом происходит внутри экосистемы Rust. Это мешает использовать стандартные инструменты сборки ОС (например, GNU LD с кастомными скриптами линковки).

## Переход на Limine

Limine — это современный, независимый загрузчик, совместимый со спецификацией Multiboot2 и EFI. Он:
- Передаёт ядру точную информацию о системе: карта физической памяти, расположение модулей, параметры командной строки.
- Не вмешивается в работу ядра после передачи управления.
- Позволяет полностью контролировать начальное состояние процессора и памяти.

Использование Limine означает, что разработчик сам отвечает за переход в 64-битный режим, настройку таблиц страниц, инициализацию GDT/IDT и другие низкоуровневые операции. Это необходимо для построения настоящего ядра, а не учебного прототипа.

## Вывод

Крейт `bootloader` — это инструмент для быстрого старта. Но как только цель выходит за рамки "напечатать строку в консоль", он начинает ограничивать возможности. Для дальнейшего развития проекта требуется загрузчик, который не навязывает своё окружение, а лишь передаёт управление — таким является Limine.

[Полный переход от bootloader к Limine в Runix](solution_bootloader)